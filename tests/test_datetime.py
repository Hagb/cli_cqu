import pytest
from datetime import datetime as dt
from cli_cqu.util.datetime import materialize_calendar
from typing import Tuple
START = "2020-02-17"


@pytest.mark.parametrize("tw, tl, ex", [
    ("1", "一[1-2节]", (dt(2020, 2, 17, 8), dt(2020, 2, 17, 9, 40))),
    ("1", "一[3-4节]", (dt(2020, 2, 17, 10, 10), dt(2020, 2, 17, 11, 50))),
    ("1", "一[5-6节]", (dt(2020, 2, 17, 14, 30), dt(2020, 2, 17, 16, 10))),
    ("1", "一[7-8节]", (dt(2020, 2, 17, 16, 40), dt(2020, 2, 17, 18, 20))),
    ("1", "一[9-11节]", (dt(2020, 2, 17, 19, 30), dt(2020, 2, 17, 22, 5))),
    ("1", "一[9-12节]", (dt(2020, 2, 17, 19, 30), dt(2020, 2, 17, 23, 59))),
    ("1", "一[14节]", (dt(2020, 2, 17, 8), dt(2020, 2, 17, 23, 59))),
    ("1", "二[1-2节]", (dt(2020, 2, 18, 8), dt(2020, 2, 18, 9, 40))),
    ("1", "二[3-4节]", (dt(2020, 2, 18, 10, 10), dt(2020, 2, 18, 11, 50))),
    ("1", "二[5-6节]", (dt(2020, 2, 18, 14, 30), dt(2020, 2, 18, 16, 10))),
    ("1", "二[7-8节]", (dt(2020, 2, 18, 16, 40), dt(2020, 2, 18, 18, 20))),
    ("1", "二[9-11节]", (dt(2020, 2, 18, 19, 30), dt(2020, 2, 18, 22, 5))),
    ("1", "二[9-12节]", (dt(2020, 2, 18, 19, 30), dt(2020, 2, 18, 23, 59))),
    ("1", "二[14节]", (dt(2020, 2, 18, 8), dt(2020, 2, 18, 23, 59))),
    ("2", "二[1-2节]", (dt(2020, 2, 25, 8), dt(2020, 2, 25, 9, 40))),
    ("2", "二[3-4节]", (dt(2020, 2, 25, 10, 10), dt(2020, 2, 25, 11, 50))),
    ("2", "二[5-6节]", (dt(2020, 2, 25, 14, 30), dt(2020, 2, 25, 16, 10))),
    ("2", "二[7-8节]", (dt(2020, 2, 25, 16, 40), dt(2020, 2, 25, 18, 20))),
    ("2", "二[9-11节]", (dt(2020, 2, 25, 19, 30), dt(2020, 2, 25, 22, 5))),
    ("2", "二[9-12节]", (dt(2020, 2, 25, 19, 30), dt(2020, 2, 25, 23, 59))),
    ("2", "二[14节]", (dt(2020, 2, 25, 8), dt(2020, 2, 25, 23, 59))),
])
def test_materialize_calendar(tw: str, tl: str, ex: Tuple[dt, dt]):
    assert ex == materialize_calendar(tw, tl, start=dt(2020, 2, 17))
